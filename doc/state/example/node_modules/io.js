const ports = {}

let timer
module.exports = io
function io(id, name, on) {
  const on_rx = {}
  ports[id] = { id, name, on}
  return send

  async function send(data) {
    const port = ports[data.to] || ports[await find_id(data.to)] || on_rx
    return port.on[data.type](data.args)
  }
  async function find_id (name){
    return (Object.values(ports).filter(node => node.name === name)[0] || undefined)
  }
}